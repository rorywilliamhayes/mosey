CREATE TABLE ACCOUNTS (
    ACCOUNT_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ACCOUNT_TYPE VARCHAR2(10) CHECK (ACCOUNT_TYPE IN ('USER', 'BUSINESS')),
    ACCOUNT_NAME VARCHAR2(100) NOT NULL,
    ACCOUNT_USERNAME VARCHAR2(50) UNIQUE NOT NULL,
    ACCOUNT_PHOTO_URL VARCHAR2(500),
    ACCOUNT_BIO VARCHAR2(1000),
    ACCOUNT_CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    ACCOUNT_UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP
);

CREATE TABLE USERS (
    ACCOUNT_ID NUMBER PRIMARY KEY REFERENCES ACCOUNTS(ACCOUNT_ID),
    USER_LOCATION_LAT NUMBER(9,6),
    USER_LOCATION_LNG NUMBER(9,6)
);

CREATE TABLE BUSINESSES (
    ACCOUNT_ID NUMBER PRIMARY KEY REFERENCES ACCOUNTS(ACCOUNT_ID),
    BUSINESS_ADDRESS VARCHAR2(300),
    LOCATION_LAT NUMBER(9,6),
    LOCATION_LNG NUMBER(9,6),
    FOOD_TYPE VARCHAR2(100),
    STAFF_RECOMMENDATIONS VARCHAR2(1500)
);

CREATE TABLE POSTS (
    POST_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    USER_ID NUMBER REFERENCES USERS(ACCOUNT_ID),
    BUSINESS_ID NUMBER REFERENCES BUSINESSES(ACCOUNT_ID),
    CAPTION VARCHAR2(8000),
    POST_CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    POST_UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP
);

CREATE TABLE POST_LIKES (
    USER_ID NUMBER REFERENCES USERS(ACCOUNT_ID),
    POST_ID NUMBER REFERENCES POSTS(POST_ID),
    LIKED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    PRIMARY KEY (USER_ID, POST_ID)
);

CREATE TABLE POST_RATINGS (
    USER_ID NUMBER REFERENCES USERS(ACCOUNT_ID),
    POST_ID NUMBER REFERENCES POSTS(POST_ID),
    RATING NUMBER(2,1) CHECK (RATING BETWEEN 0 AND 9),
    RATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    PRIMARY KEY (USER_ID, POST_ID)
);

CREATE TABLE POST_IMAGES (
    IMAGE_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    POST_ID NUMBER NOT NULL REFERENCES POSTS(POST_ID),
    POST_IMAGE_URL VARCHAR2(400)
);
